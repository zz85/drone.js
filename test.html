<html>
	<body>
	Hello world
	<input />
	<div id="debug"></div>


		<script>
		// see http://html5gamepad.com/
		// Press any button on your gamepad(s) to make them show up
		// or switch tabs!

		// https://developer.mozilla.org/en-US/docs/Web/API/Gamepad
		// https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API/Using_the_Gamepad_API
		// https://www.smashingmagazine.com/2015/11/gamepad-api-in-web-games/

			'use strict';

			var currentPad;
			var gp;
			var start = performance.timing.navigationStart;

			window.addEventListener('gamepadconnected', function(e) {
				console.log('Gamepad connected at index %d: %s. %d buttons, %d axes.',
				e.gamepad.index, e.gamepad.id,
				e.gamepad.buttons.length, e.gamepad.axes.length);

				currentPad = e.gamepad;

				animate();


			});

			window.addEventListener('gamepaddisconnected', function(e) {
			 	console.log('Gamepad disconnected from index %d: %s',
				e.gamepad.index, e.gamepad.id);
			});


			function animate() {
				requestAnimationFrame(animate);

				console.log('test');
				var gamepads = navigator.getGamepads();
			  	gp = gamepads[currentPad.index];

				if (gp) {

			    	// status.innerHTML = "Gamepad connected at index " + gp.index + ": " + gp.id +
			     //    ". It has " + gp.buttons.length + " buttons and " + gp.axes.length + " axes.";
			 		debug.innerHTML = `Axes: ${gp.axes.map( (a,b)=> `#${b}: ${a} `)} <br>
			 		Buttons: ${gp.buttons.map( (b, i) => `#${i}: ${b.pressed? 'on' : 'off'} ${b.value}` )}<br/>
			 		Timestamp: ${new Date(start + gp.timestamp / 1000 / 1000 )}<br/>
			 		Connected: ${gp.connected}<br/>
			 		Mapping: ${gp.mapping}<br/>
			 		`;
			    }
			}

			function applyDeadzone (number, threshold){
				percentage = (Math.abs(number) - threshold) / (1 - threshold);

				if(percentage < 0)
					percentage = 0;

			   return percentage * (number > 0 ? 1 : -1);
			}


			function Drone() {
				this.altitude = 0; // z
				this.bearing = 0;

				this.gps = [0, 0]; // x y
			}


		</script>

	</body>
</html>